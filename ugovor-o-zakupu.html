<!DOCTYPE html>
<html lang="sr-Latn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ugovor o zakupu - ugovor24.com</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="https://ugovor24-site.vercel.app/favicon.ico">
</head>
<body>
    <header>
        <div class="header-container">
            <a href="index.html" class="logo">
                ugovor<span class="logo-blue">24</span>.com
            </a>
            <nav>
                <a href="index.html">Početna</a>
                <a href="ugovori.html">Ugovori</a>
                <a href="kontakt.html">Kontakt</a>
            </nav>
        </div>
    </header>

    <main>
        <div class="form-container">
            <h1>Ugovor o zakupu</h1>
            <p class="form-intro">Molimo popunite formular ispod kako biste generisali Vaš Ugovor o zakupu. Nakon popunjavanja, bićete preusmjereni na stranicu za plaćanje.</p>

            <form id="ugovor-o-zakupu-form">
                
                <input type="hidden" name="ugovor_type" value="Ugovor o zakupu">

                <div class="form-section">
                    <h3>Opšte informacije</h3>
                    <label for="mjesto_zakljucenja">Mjesto zaključenja:</label>
                    <input type="text" id="mjesto_zakljucenja" name="mjesto_zakljucenja" required>

                    <label for="datum_zakljucenja">Datum zaključenja:</label>
                    <input type="date" id="datum_zakljucenja" name="datum_zakljucenja" required>
                </div>

                <div class="form-section">
                    <h3>Podaci o Zakupodavcu</h3>
                    <label for="naziv_zakupodavca">Naziv Zakupodavca:</label>
                    <input type="text" id="naziv_zakupodavca" name="naziv_zakupodavca" required>

                    <label for="adresa_zakupodavca">Adresa Zakupodavca:</label>
                    <input type="text" id="adresa_zakupodavca" name="adresa_zakupodavca" required>
                    
                    <label for="id_broj_zakupodavca">ID broj (JMBG/PIB) Zakupodavca:</label>
                    <input type="text" id="id_broj_zakupodavca" name="id_broj_zakupodavca" required>
                </div>

                <div class="form-section">
                    <h3>Podaci o Zakupcu</h3>
                    <label for="naziv_zakupca">Naziv Zakupca:</label>
                    <input type="text" id="naziv_zakupca" name="naziv_zakupca" required>

                    <label for="adresa_zakupca">Adresa Zakupca:</label>
                    <input type="text" id="adresa_zakupca" name="adresa_zakupca" required>
                    
                    <label for="id_broj_zakupca">ID broj (JMBG/PIB) Zakupca:</label>
                    <input type="text" id="id_broj_zakupca" name="id_broj_zakupca" required>
                </div>

                <div class="form-section">
                    <h3>Detalji Prostora za zakup</h3>
                    <label for="tip_prostora">Tip prostora:</label>
                    <input type="text" id="tip_prostora" name="tip_prostora" required>

                    <label for="adresa_prostora">Adresa prostora:</label>
                    <input type="text" id="adresa_prostora" name="adresa_prostora" required>

                    <label for="povrsina_prostora">Površina prostora (u m²):</label>
                    <input type="number" id="povrsina_prostora" name="povrsina_prostora" required>

                    <label for="broj_lista_nepokretnosti">Broj lista nepokretnosti:</label>
                    <input type="text" id="broj_lista_nepokretnosti" name="broj_lista_nepokretnosti" required>
                    
                    <label for="katastarska_opstina">Katastarska opština:</label>
                    <input type="text" id="katastarska_opstina" name="katastarska_opstina" required>

                    <label for="opis_prostorija">Detaljan opis prostorija (npr. Dnevna soba, spavaća soba, kuhinja...):</label>
                    <textarea id="opis_prostorija" name="opis_prostorija" rows="3" required></textarea>

                    <label for="namjena_prostora">Namjena prostora:</label>
                    <input type="text" id="namjena_prostora" name="namjena_prostora" required>
                </div>

                <div class="form-section">
                    <h3>Uslovi zakupa</h3>
                    <label for="period_zakupa">Period zakupa (broj):</label>
                    <input type="number" id="period_zakupa" name="period_zakupa" required>

                    <label for="jedinica_perioda_zakupa">Jedinica perioda zakupa:</label>
                    <select id="jedinica_perioda_zakupa" name="jedinica_perioda_zakupa" required>
                        <option value="mjeseci">mjeseci</option>
                        <option value="godina">godina</option>
                    </select>

                    <label for="datum_pocetka_zakupa">Datum početka zakupa:</label>
                    <input type="date" id="datum_pocetka_zakupa" name="datum_pocetka_zakupa" required>

                    <label for="iznos_zakupnine_broj">Iznos mjesečne zakupnine (u EUR):</label>
                    <input type="number" id="iznos_zakupnine_broj" name="iznos_zakupnine_broj" required>

                    <label for="dan_u_mjesecu_za_placanje">Dan u mjesecu za plaćanje zakupnine:</label>
                    <input type="number" id="dan_u_mjesecu_za_placanje" name="dan_u_mjesecu_za_placanje" required>

                    <label for="otkazni_rok">Otkazni rok (u danima):</label>
                    <input type="number" id="otkazni_rok" name="otkazni_rok" required>
                    
                    <label for="definisan_depozit">Da li je definisan depozit?</label>
                    <select id="definisan_depozit" name="definisan_depozit" required>
                        <option value="Ne">Ne</option>
                        <option value="Da">Da</option>
                    </select>

                    <div id="iznos_depozita_field" style="display:none;">
                        <label for="iznos_depozita_broj">Iznos depozita (u EUR):</label>
                        <input type="number" id="iznos_depozita_broj" name="iznos_depozita_broj">
                    </div>
                </div>

                <div class="form-section">
                    <h3>Dodatne opcije</h3>
                    <label for="definisana_indeksacija">Da li želite indeksaciju zakupnine?</label>
                    <select id="definisana_indeksacija" name="definisana_indeksacija" required>
                        <option value="Ne">Ne</option>
                        <option value="Da">Da</option>
                    </select>

                    <label for="dozvoljen_podzakup">Da li je dozvoljen podzakup?</label>
                    <select id="dozvoljen_podzakup" name="dozvoljen_podzakup" required>
                        <option value="Ne">Ne</option>
                        <option value="Da">Da</option>
                    </select>

                    <label for="strana_koja_placa_solemnizaciju">Ko plaća solemnizaciju ugovora kod notara?</label>
                    <select id="strana_koja_placa_solemnizaciju" name="strana_koja_placa_solemnizaciju" required>
                        <option value="Zakupodavac">Zakupodavac</option>
                        <option value="Zakupac">Zakupac</option>
                        <option value="Obe strane po pola">Obe strane po pola</option>
                    </select>
                </div>

                <div class="form-section">
                    <h3>Vaši podaci</h3>
                    <label for="client_email">Vaš e-mail:</label>
                    <input type="email" id="client_email" name="client_email" required>
                </div>
                
                <div class="form-actions">
                    <div class="terms-checkbox">
                        <input type="checkbox" id="terms_acceptance" name="terms_acceptance" required>
                        <label for="terms_acceptance">Saglasan/na sam sa <a href="uslovi_koriscenja.html" target="_blank">Uslovima korišćenja</a> i <a href="politika_privatnosti.html" target="_blank">Politikom privatnosti</a>.</label>
                    </div>
                    <button type="submit" class="submit-button">Generiši Ugovor (79 EUR)</button>
                </div>
            </form>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 ugovor24.com. Sva prava zadržana.</p>
    </footer>

    <script>
        const definisanDepozitSelect = document.getElementById('definisan_depozit');
        const iznosDepozitaField = document.getElementById('iznos_depozita_field');

        definisanDepozitSelect.addEventListener('change', (e) => {
            if (e.target.value === 'Da') {
                iznosDepozitaField.style.display = 'block';
                document.getElementById('iznos_depozita_broj').required = true;
            } else {
                iznosDepozitaField.style.display = 'none';
                document.getElementById('iznos_depozita_broj').required = false;
            }
        });

        // Novi kod za slanje forme
        const currentForm = document.querySelector('form');
        currentForm.addEventListener('submit', async (event) => {
            event.preventDefault(); // Sprečavamo standardno slanje forme

            const submitButton = currentForm.querySelector('button[type="submit"]');
            const originalButtonText = submitButton.textContent;
            submitButton.disabled = true;
            submitButton.textContent = 'Šaljem podatke...';

            // Pretvaramo podatke iz forme u format koji naša API funkcija očekuje (JSON)
            const formData = new FormData(currentForm);
            const data = Object.fromEntries(formData.entries());

            try {
                const response = await fetch('/api/submit-form.js', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data),
                });

                const result = await response.json();

                if (response.ok && result.success) {
                    // Ako je sve prošlo kako treba, preusmjeravamo korisnika na stranicu za plaćanje
                    window.location.href = result.redirectUrl;
                } else {
                    // U slučaju greške, prikazujemo poruku
                    alert('Došlo je do greške: ' + (result.error || 'Molimo pokušajte ponovo.'));
                    submitButton.disabled = false;
                    submitButton.textContent = originalButtonText;
                }
            } catch (error) {
                console.error('Greška pri slanju forme:', error);
                alert('Došlo je do neočekivane greške. Molimo provjerite Vašu internet konekciju i pokušajte ponovo.');
                submitButton.disabled = false;
                submitButton.textContent = originalButtonText;
            }
        });
    </script>
</body>
</html>
